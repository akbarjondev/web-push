<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Service Worker</title>
</head>
<body>

	<button id="subscribe">Subscribe</button>
	<button id="unsubscribe">Unsubscribe</button>

	<script>

		addEventListener('load', async () => {

			await navigator.serviceWorker.register('./serviceWoker.js')
		})

		subscribe.addEventListener('click', async () => {

			console.log('subscribe')

			const worker = await navigator.serviceWorker.ready

			const pushManager = await worker.pushManager.subscribe({
				userVisibleOnly: true,
				applicationServerKey: "BBrSLCPyECboR8i2adR0VZ0qbIpY96Is0NSgSfRxZ4eYscNubEAbIVl14RbR68DTpqzznRETBDlPamZZzZ9s4Tw"
			})

			console.log(JSON.stringify(pushManager, null, 4))

		})

		unsubscribe.addEventListener('click', async () => {

			console.log('unsubscribe')

			const worker = await navigator.serviceWorker.ready

			const subscription = await worker.pushManager.getSubscription()

			await subscription.unsubscribe()

		})

  </script>
	
</body>
</html>